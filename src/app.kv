WindowManager:
    MainScreen:
    ResultsScreen:
    InfoScreen:


<MyButton@Button>:
    font_name: 'Tahoma'
    font_size: 0.5 * self.height
    background_color: 0, 0, 0, 0
    size_hint: 0.1, 0.05
    canvas.before:
        Color:
            rgba: 0, 0, 0, 1
        RoundedRectangle:
            size: self.size
            pos: self.pos
            radius: [10] 


<Label>:
    font_name: 'Tahoma'
    font_size: 17


<MySpinner>:
    size_hint: None, None
    size: 100, 44
    background_color: 0, 0, 0, 1


<FloatLayout>:
    canvas.before:
        Color:
            rgba: 0.188, 0.851, 0.396, 1
        Rectangle:
            pos: self.pos
            size: self.size


<MainScreen>:
    name: "main_screen"
    id: main_screen
    FloatLayout:
        Label:
            text: "LOGO APLIKACJI"
            size_hint: 1 , 0.1
            pos: 0, 0.9 * root.height

        FileInfo:
            id: file_info
            size_hint: 1, 0.1
            multiline: True
            pos: 0, 0.75 * root.height

        FileChooserIconView:
            id: filechooser
            path: "data"
            size_hint_y: 0.65
            height: 100
            on_selection: main_screen.click_file(filechooser.selection)

        Label:
            text: 'Kolumna dystansów:'
            pos_hint: {'center': (.2, .7)}
        
        MySpinner:
            id: spinner_distance
            pos_hint: {'center': (.3, .7)}
        
        Label:
            text: 'Kolumna czasów:'
            pos_hint: {'center': (.6, .7)}

        MySpinner:
            id: spinner_time
            pos_hint: {'center': (.7, .7)}
        
        MyButton:
            id: go_info
            text: "Instrukcja"
            pos: 0.25 * root.width, 0.05 * root.height
            on_release:
                root.manager.transition.direction = "right"
                app.root.current = "info_screen"

        MyButton:
            id: go_results
            text: "Dalej"
            pos: 0.65 * root.width, 0.05 * root.height
            on_release:
                root.manager.transition.direction = "left"
                main_screen.go_results_action()


<ResultsScreen>:
    name: "results_screen"
    id: results_screen
    FloatLayout:
        Label:
            text: 'Dystans [km]'
            size_hint: 0.1, 0.05
            pos: 0.1 * root.width, 0.8 * root.height

        TextInput:
            id: distance_input
            text: 'Podaj dystans'
            padding_x: 0.15 * self.width
            multiline: False
            input_filter: 'float'
            on_focus: self.text = '' if args[1] else self.text
            size_hint: 0.15, 0.05
            pos: 0.3 * root.width, 0.8 * root.height
            background_color: 0, 0, 0, 1
            font_size: 17
            foreground_color: (1, 1, 1, 1)

        Label:
            text: 'Zmiana masy'
            pos: 0.1 * root.width, 0.7 * root.height
            size_hint: 0.1, 0.05

        Slider:
            id: weight_slider
            min: -5
            max: 5
            step: 0.5
            orientation: 'horizontal'
            size_hint: 0.4, 0.05
            pos: 0.5 * root.width, 0.7 * root.height
            cursor_image: app.assets["runner_icon"]
            on_touch_up: root.show_predictions()

        Label:
            id: weight_display
            text: str(weight_slider.value) + ' %'
            pos: 0.3 * root.width, 0.7 * root.height
            size_hint: 0.15, 0.05
            background_color: 0, 0, 0, 1
            canvas.before:
                Color:
                    rgba: self.background_color
                Rectangle:
                    pos: self.pos
                    size: self.size
        
        # No "Oblicz" button. Calculations done automatically!

        MyButton:
            id: results_go_main
            text: "Powrót"
            pos: 0.45 * root.width, 0.05 * root.height
            on_release:
                root.manager.transition.direction = "right"
                app.root.current = "main_screen"
                

        BoxLayout:
            orientacion: "horizontal"
            size: (0.6 * root.width, 0.1 * root.height)
            size_hint: None, None
            pos: 0.2*root.width, 0.45*root.height

            Label:
                text: "Prognozowany czas:"
                canvas.before:
                    Color:
                        rgba: 0, 0, 0, 1
                    Rectangle:
                        pos: self.pos
                        size: self.size

            Label:
                id: est_time
                text: "---"
                canvas.before:
                    Color:
                        rgba: 0, 0, 0, 1
                    Rectangle:
                        pos: self.pos
                        size: self.size

        GridLayout:
            cols: 1
            rows: 1
            size: (0.6 * root.width, 0.25 * root.height)
            size_hint: None, None
            pos: 0.2 * root.width, 0.2 * root.height
            canvas.before:
                Color:
                    rgba: 0, 0, 0, 0.3
                Rectangle:
                    pos: self.pos
                    size: self.size
            Label:
                id: result_warnings
                multiline: True
                text: 'Ewentualne błędy/ostrzeżenia.'         



<InfoScreen>:
    name: "info_screen"
    id: info_screen
    FloatLayout:
        Label:
            pos_hint: {'center': (.5, 0.8)}
            multiline: True
            markup: True
            text: "[size=20][u]Instrukcja[/u][/size] \nPo wybraniu pliku csv można rozwinąć listę z nazwami kolumn i wybrać odpowiednie dla czasu i dystansu."

        MyButton:
            id: info_go_main
            text: "Powrót"
            pos: 0.45 * root.width, 0.05 * root.height
            on_release:
                root.manager.transition.direction = "left"
                app.root.current = "main_screen"
 